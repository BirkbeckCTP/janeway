{% extends "admin/core/base.html" %}
{% load foundation %}

{% block title %}Reminders Dashboard{% endblock title %}
{% block title-section %}Reminders Dashboard{% endblock %}
{% block title-sub %}View reminder information{% endblock %}

{% block breadcrumbs %}
    {{ block.super }}
    <li><a href="{% url 'core_manager_index' %}">Manager</a></li>
    <li><a href="{% url 'cron_home' %}">Cron</a></li>
    <li><a href="{% url 'cron_reminders_dashboard' %}">Reminders Dashboard</a></li>
{% endblock %}

{% block body %}
    <div class="large-12 columns">
        <div class="box">
            <div class="title-area">
                <h2>Active Reminders</h2>
                <a class=" button" href="{% url 'cron_create_reminder' %}"><i class="fa fa-plus">&nbsp;</i>Add Reminders</a>
            </div>
            <div class="content">
                <p>Currently active Review and Revision reminders are listed below. There are three types of reminder email supported by Janeway:</p>
                <ul>
                    <li>Review (Invited) - sent when a reviewer has been invited but not responded.</li>
                    <li>Review (Accepted) - sent when a reviewer has accepted a review request.</li>
                    <li>Revision - Sent for revision requests.</li>
                </ul>
                {% for reminder in reminders %}
                    <div class="title-area">
                        <h2>
                            Reminder #{{ reminder.pk }}
                        </h2>
                    </div>
                    <p>Sent {{ reminder.days }} days {{ reminder.run_type }} {{ reminder.get_type_display }} is
                        due. Currently targeting reviews due on <strong>{{ reminder.target_date|date:"Y-m-d" }}</strong>.</p>
                    <table>
                        <tr>
                            <th>Article</th>
                            <th>Review ID</th>
                            <th>Review Due</th>
                            <th>Reminder Sent?</th>
                        </tr>
                        {% for review_assignment in reminder.items_for_reminder %}
                            <tr>
                                <td>{{ review_assignment.article.title }}</td>
                                <td>{{ review_assignment.pk }}</td>
                                <td>{{ review_assignment.date_due|date:"Y-m-d" }}</td>
                                <td>TODO: Check if reminder has been sent.</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4">No assignments due on target date.</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock body %}